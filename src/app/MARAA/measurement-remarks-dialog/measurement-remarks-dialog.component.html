<h2 mat-dialog-title class="dialog-title">פרטי מקרה</h2>

<mat-dialog-content class="dialog-content" dir="rtl">
  <mat-card class="info-card">
    <mat-card-content>
      <div class="info-grid">
        <div>
          <div><strong>קוד מדד:</strong> {{ data?.Measurment_ID }}</div>
          <div><strong>מספר מקרה:</strong> {{ data?.Case_Number }}</div>
        </div>
        <div><strong>תיאור:</strong> {{ (data?.measurementShortDesc || data?.measurementShortDesc) }}</div>
        <div><strong>תאריך:</strong> {{ (data?.date || data?.Date) | date:'dd/MM/yyyy' }}</div>
        <div><strong>מונה:</strong> {{ (data?.mone || data?.Mone) }}</div>
        <div><strong>מכנה:</strong> {{ (data?.mechane || data?.Mechane) }}</div>
        <div><strong>מחלקה:</strong> {{ (data?.department || data?.Department) }}</div>
      </div>
    </mat-card-content>
  </mat-card>

  <mat-form-field appearance="outline" class="remarks-field" floatLabel="always">
    <mat-label>הערות</mat-label>
    <textarea matInput [(ngModel)]="remarks" rows="3"></textarea>
  </mat-form-field>

  <!-- בקשה לגרוע -->
  <mat-checkbox [(ngModel)]="subtract" (change)="onSubtractChange()">בקשה לגרוע</mat-checkbox>
  <div class="meta">
    <span *ngIf="(data?.entryUserSubtract || data?.EntryUserSubtract)">
      נרשם על ידי: {{ (data?.entryUserSubtract || data?.EntryUserSubtract) }}
    </span>
    <span *ngIf="(data?.entryDateSubtract || data?.EntryDateSubtract)">
      בתאריך {{ (data?.entryDateSubtract || data?.EntryDateSubtract) | date:'dd/MM/yyyy HH:mm' }}
    </span>
  </div>

  <!-- מאושר מבר (רק NBENSHIMON) -->
  <ng-container *ngIf="isNBenShimon">
    <mat-checkbox [(ngModel)]="aprovedMabar" (change)="onApproveChange()">
      מאושר מבר
    </mat-checkbox>
    <div class="meta">
      <span *ngIf="(data?.entryUserAprovedMabar || data?.EntryUserAprovedMabar)">
        נרשם על ידי: {{ (data?.entryUserAprovedMabar || data?.EntryUserAprovedMabar) }}
      </span>
      <span *ngIf="(data?.entryDateAprovedMabar || data?.EntryDateAprovedMabar)">
        בתאריך {{ (data?.entryDateAprovedMabar || data?.EntryDateAprovedMabar) | date:'dd/MM/yyyy HH:mm' }}
      </span>
    </div>
  </ng-container>

  <!-- NEW: בקשה אישית -->
 <!-- add a new checkbox next to the others -->
<mat-checkbox [(ngModel)]="personalRequest" (change)="onPersonalChange()">
  בקשה להשגה פרטנית
</mat-checkbox>

<div class="meta">
  <span *ngIf="(data?.EntryUserPersonalRequest || data?.entryUserPersonalRequest)">
    נרשם על ידי: {{ (data?.EntryUserPersonalRequest || data?.entryUserPersonalRequest) }}
  </span>
  <span *ngIf="(data?.EntryDatePersonalRequest || data?.entryDatePersonalRequest)">
    בתאריך {{ (data?.EntryDatePersonalRequest || data?.entryDatePersonalRequest) | date:'dd/MM/yyyy HH:mm' }}
  </span>
</div>


</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button (click)="dialogRef.close()">ביטול</button>
  <button mat-raised-button color="primary" (click)="submit()">שמור</button>
</mat-dialog-actions>
